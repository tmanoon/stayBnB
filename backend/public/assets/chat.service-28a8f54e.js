import{i as a,h as n}from"./index-14898d18.js";const o="chat/",p={query:d,remove:l,update:h,add:y,getById:u,getByOrderId:g,getUserPosition:s,getEmptyMsg:f};async function d(e={type:"all",unread:!1}){try{const t=a.getLoggedInUser()._id;let r=await n.get(o+t);return e.unread,e.type!=="all"&&(r=r.filter(c=>{const i=s(t,c);return i==="both"||i===e.type})),r}catch(t){throw console.log(t),t}}async function u(e){try{return await n.get(o+"user/"+e)}catch(t){console.log(t)}}async function l(e){try{await n.delete(o+e)}catch(t){console.log(t)}}async function g(e){try{return await n.get(o+"order/"+e)}catch(t){throw console.log("err",t),t}}async function h(e){try{return await n.put(o+e._id,e)}catch(t){console.log(t)}}async function y(e){try{const t=await a.getById(e.hostId),r=await a.getById(e.buyer._id),c={createdAt:new Date().getTime(),orderId:e._id,host:{_id:e.hostId,fullname:t.fullname,imgUrl:t.imgUrl},buyer:{_id:r._id,fullname:r.fullname,imgUrl:r.imgUrl},msgs:[]};return await n.post(o,c)}catch(t){throw console.log("err",t),t}}function s(e,t){if(e===t.host._id&&e===t.buyer._id)return"both";if(e===t.host._id)return"host";if(e===t.buyer._id)return"buyer"}function f(){const e=a.getLoggedInUser();return{at:new Date().getTime(),by:e._id,txt:""}}export{p as c};
