import{h as n,d as l,E as d,u as i}from"./index-33d448ca.js";const a="order/",S={query:c,getById:u,getHostOrdersById:y,getUserOrdersById:f,getUserOrHostOrdersById:g,filterUserOrders:D,save:_,remove:h,getOrder:m,createDemoOrder:w};async function c(){try{return await n.get(a)}catch(t){throw console.log(t),t}}async function u(t){try{return await n.get(a+t)}catch(e){console.log(e)}}async function y(t,e){try{l.dispatch({type:d,isLoading:!0});let r=await c();return r=r.filter(o=>o.hostId===t).filter(o=>new Date(+o.entryDate).getMonth()>=new Date().getMonth()),l.dispatch({type:d,isLoading:!1}),e==="date"?r.sort((o,s)=>o.entryDate-s.entryDate):e==="name"?r.sort((o,s)=>o.stay._id.localeCompare(s.stay._id)):r}catch(r){console.log(r)}}async function f(t){try{let e=await c();return e=e.filter(r=>r.buyer._id===t),e}catch(e){console.log(e)}}async function g(t){try{let e=await c();return e=e.filter(r=>r.buyer._id===t||r.hostId===t),e}catch(e){console.log(e)}}function D(t,e){if(e.tense!=="all"){const r=new Date().getTime();e.tense==="future"?t=t.filter(o=>o.exitDate>=r):e.tense==="current"?t=t.filter(o=>o.entryDate<=r&&o.exitDate>=r):e.tense==="past"&&(t=t.filter(o=>o.exitDate<=r))}return e.status!=="all"&&(t=t.filter(r=>r.status===e.status)),t.sort((r,o)=>r.entryDate-o.entryDate)}async function h(t){try{await n.delete(a+t)}catch(e){console.log(e)}}async function _(t){try{return t._id?await n.put(a+t._id,t):await await n.post(a,t)}catch(e){console.log(e)}}async function m(t,e,r){try{return{hostId:t.host.id,buyer:{_id:e._id,fullname:e.fullname},totalPrice:i.calcSumToPay(r,t),entryDate:r.entryDate,exitDate:r.exitDate,status:"pending",guests:{adults:+r.adults||0,children:+r.children||0,infants:+r.infants||0,pets:+r.pets||0},stay:{_id:t._id,name:t.name,price:t.price,location:{address:t.loc.address,city:t.loc.city,country:t.loc.country},imgUrls:t.imgUrls,sumOfBedrooms:t.bbb.numOfBedrooms}}}catch(o){throw console.log("err",o),o}}function w(){return i.loadFromStorage(ORDER_DB)?i.loadFromStorage(ORDER_DB):i.saveToStorage(ORDER_DB,orders)}export{S as o};
