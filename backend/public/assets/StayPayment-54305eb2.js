import{j as e,u as n,r as t,b as M,k as T,t as R,m as V,a as z,o as G}from"./index-a1492c3f.js";import{a as E}from"./order.actions-16abc5b2.js";import{G as I,D as O}from"./DatesModal-96c3f861.js";import"./order.service-2a201b28.js";import"./chat.service-b06ddfd2.js";function _({stay:a,searchParams:s}){function r(i){return i.length>141?i.slice(0,141)+"...":i}return e.jsxs("div",{className:"payment-modal flex column",children:[e.jsxs("div",{className:"stay-details flex",children:[e.jsx("img",{src:a.imgUrls[0]}),e.jsxs("div",{className:"text-details flex column",children:[e.jsx("h2",{children:r(a.summary)}),e.jsx("p",{className:"property-type",children:a.propertyType}),e.jsxs("p",{children:["★ ",n.calcRate(a).toFixed(2)," (",a.reviews.length," reviews)"]})]})]}),e.jsxs("div",{className:"price-details",children:[e.jsx("h1",{children:"Price details"}),e.jsxs("div",{className:"accommodation flex space-between",children:[e.jsxs("p",{children:["$",a.price," X ",n.calcSumOfDays(s)===1?`${n.calcSumOfDays(s)} night`:`${n.calcSumOfDays(s)} nights`]}),e.jsxs("p",{className:"sum",children:["$",a.price*n.calcSumOfDays(s)*(+s.adults+ +s.children)]})]}),e.jsxs("div",{className:"fee flex space-between",children:[e.jsx("p",{children:"Staybnb service fee"}),e.jsxs("p",{children:["$",Math.ceil(n.calcSumToPay(s,a)*.14125)]})]}),e.jsxs("div",{className:"total flex space-between",children:[e.jsxs("p",{children:["Total ",e.jsx("span",{children:"(USD)"})]}),e.jsxs("p",{children:["$",Math.ceil(n.calcSumToPay(s,a))+Math.ceil(n.calcSumToPay(s,a)*.14125)]})]})]})]})}function L({userOrderDetails:a,onUserOrderDetails:s}){const[r,i]=t.useState(!0),[h,x]=t.useState(e.jsxs(e.Fragment,{children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32","aria-label":"Credit card",role:"img",focusable:"false",style:{display:"block",height:"33px",width:"33px",fill:"rgb(176, 176, 176)"},children:e.jsx("path",{d:"M29 5a2 2 0 0 1 2 1.85V25a2 2 0 0 1-1.85 2H3a2 2 0 0 1-2-1.85V7a2 2 0 0 1 1.85-2H3zm0 6H3v14h26zm-3 10a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm-4 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm7-14H3v2h26z"})}),e.jsx("p",{children:"     Credit or debit card"})]})),[d,m]=t.useState("arrow-down");function p(){m(d==="arrow-down"?"arrow-up":"arrow-down")}function j(l,g){l.stopPropagation(),g==="credit"?(i(!0),x(e.jsxs(e.Fragment,{children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32","aria-label":"Credit card",role:"img",focusable:"false",style:{display:"block",height:"33px",width:"33px",fill:"rgb(176, 176, 176)"},children:e.jsx("path",{d:"M29 5a2 2 0 0 1 2 1.85V25a2 2 0 0 1-1.85 2H3a2 2 0 0 1-2-1.85V7a2 2 0 0 1 1.85-2H3zm0 6H3v14h26zm-3 10a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm-4 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm7-14H3v2h26z"})}),e.jsx("p",{children:"Credit or debit card"})]})),m("arrow-down")):(x(e.jsxs(e.Fragment,{children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 44 32","aria-label":"Google Pay",role:"img",focusable:"false",style:{display:"block",height:"33px",width:"33px"},children:e.jsxs("g",{fill:"none",fillRule:"evenodd",children:[e.jsx("path",{fill:"#3C4043",fillRule:"nonzero",d:"M21.2 15.58v4.54h-1.42V8.9h3.77a3.35 3.35 0 0 1 2.44.97 3.27 3.27 0 0 1 .16 4.59l-.16.16c-.66.63-1.48.96-2.44.96H21.2zm0-5.3v3.92h2.39a1.84 1.84 0 0 0 1.4-.58 2 2 0 0 0-.04-2.79 1.92 1.92 0 0 0-1.36-.56H21.2zm9.09 1.91c1.05 0 1.88.29 2.49.85.6.57.9 1.35.9 2.35v4.73h-1.35v-1.06h-.07a2.7 2.7 0 0 1-2.34 1.32c-.83 0-1.54-.25-2.1-.76a2.39 2.39 0 0 1-.83-1.88c0-.8.3-1.42.89-1.9a3.7 3.7 0 0 1 2.37-.7c.85 0 1.54.16 2.09.46v-.33c0-.49-.22-.96-.59-1.28a2.05 2.05 0 0 0-1.37-.53c-.79 0-1.42.34-1.88 1.02l-1.25-.8c.67-.99 1.69-1.49 3.04-1.49zm-1.84 5.58c0 .38.18.73.47.94.32.25.7.39 1.1.38.6 0 1.18-.25 1.6-.68.47-.44.7-.97.7-1.58a2.81 2.81 0 0 0-1.85-.53c-.57 0-1.06.14-1.44.42-.39.28-.58.63-.58 1.05z"}),e.jsx("path",{fill:"#3C4043",d:"M41.49 12.44 36.74 23.5h-1.47l1.77-3.87-3.12-7.19h1.55l2.25 5.52h.03l2.2-5.52z"}),e.jsx("path",{fill:"#4285F4",d:"M15.46 14.59c0-.44-.04-.88-.1-1.3h-6v2.47h3.43a2.99 2.99 0 0 1-1.27 1.97v1.6h2.05a6.33 6.33 0 0 0 1.89-4.74z"}),e.jsx("path",{fill:"#34A853",d:"M9.36 20.9c1.71 0 3.16-.58 4.2-1.56l-2.04-1.62a3.81 3.81 0 0 1-5.73-2.04H3.7v1.67a6.34 6.34 0 0 0 5.67 3.54z"}),e.jsx("path",{fill:"#FBBC04",d:"M5.8 15.68a3.94 3.94 0 0 1 0-2.47v-1.66H3.67a6.47 6.47 0 0 0 0 5.79l2.11-1.66z"}),e.jsx("path",{fill:"#EA4335",d:"M9.36 10.55a3.4 3.4 0 0 1 2.43.97l1.82-1.84A6.09 6.09 0 0 0 9.36 8c-2.4 0-4.6 1.38-5.68 3.56l2.11 1.66a3.8 3.8 0 0 1 3.57-2.67z"}),e.jsx("path",{fill:"#B0B0B0",d:"M2.04 1C1.47 1 1 1.47 1 2.05v27.9c0 .58.47 1.05 1.04 1.05h39.92c.57 0 1.04-.47 1.04-1.05V2.05C43 1.47 42.53 1 41.96 1H2.04zM0 2.05C0 .92.9 0 2.04 0h39.92C43.1 0 44 .92 44 2.05v27.9c0 1.13-.9 2.05-2.04 2.05H2.04A2.04 2.04 0 0 1 0 29.95V2.05z"})]})}),e.jsx("p",{children:"Google pay"})]})),i(!1),m("arrow-down"))}return e.jsxs("article",{className:"payment flex column",children:[e.jsxs("div",{className:"title flex align-center space-between",children:[e.jsx("h2",{children:"Pay with"}),e.jsxs("div",{className:"credit-card-imgs flex",children:[e.jsx("img",{src:"//a0.muscache.com/airbnb/static/packages/assets/frontend/legacy-shared/svgs/payments/logo_visa.0adea522bb26bd90821a8fade4911913.svg",alt:"Visa Card","aria-hidden":"true"}),e.jsx("img",{src:"//a0.muscache.com/airbnb/static/packages/assets/frontend/legacy-shared/svgs/payments/logo_amex.84088b520ca1b3384cb71398095627da.svg",alt:"American Express Card","aria-hidden":"true"}),e.jsx("img",{src:"//a0.muscache.com/airbnb/static/packages/assets/frontend/legacy-shared/svgs/payments/logo_mastercard.f18379cf1f27d22abd9e9cf44085d149.svg",alt:"Mastercard","aria-hidden":"true"}),e.jsx("img",{src:"//a0.muscache.com/airbnb/static/packages/assets/frontend/legacy-shared/svgs/payments/logo_googlepay.3f786bc031b59575d24f504dfb859da0.svg",alt:"Google Pay","aria-hidden":"true"})]})]}),e.jsxs("div",{className:"payment-div flex column",children:[e.jsxs("button",{className:"select-payment-method flex space-between align-center",onClick:p,children:[e.jsx("div",{className:"payment-method-container flex align-center",children:h}),e.jsx("span",{className:d})]}),d==="arrow-up"&&e.jsx("div",{className:"choose-payment-method",children:e.jsxs("ul",{children:[e.jsxs("li",{onClick:l=>j(l,"credit"),className:"flex",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32","aria-label":"Credit card",role:"img",focusable:"false",style:{display:"block",height:"33px",width:"33px",fill:"rgb(176, 176, 176)"},children:e.jsx("path",{d:"M29 5a2 2 0 0 1 2 1.85V25a2 2 0 0 1-1.85 2H3a2 2 0 0 1-2-1.85V7a2 2 0 0 1 1.85-2H3zm0 6H3v14h26zm-3 10a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm-4 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm7-14H3v2h26z"})}),e.jsx("p",{children:"Credit or debit card"})]}),e.jsxs("li",{onClick:l=>j(l,"google"),className:"flex",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 44 32","aria-label":"Google Pay",role:"img",focusable:"false",style:{display:"block",height:"33px",width:"33px"},children:e.jsxs("g",{fill:"none",fillRule:"evenodd",children:[e.jsx("path",{fill:"#3C4043",fillRule:"nonzero",d:"M21.2 15.58v4.54h-1.42V8.9h3.77a3.35 3.35 0 0 1 2.44.97 3.27 3.27 0 0 1 .16 4.59l-.16.16c-.66.63-1.48.96-2.44.96H21.2zm0-5.3v3.92h2.39a1.84 1.84 0 0 0 1.4-.58 2 2 0 0 0-.04-2.79 1.92 1.92 0 0 0-1.36-.56H21.2zm9.09 1.91c1.05 0 1.88.29 2.49.85.6.57.9 1.35.9 2.35v4.73h-1.35v-1.06h-.07a2.7 2.7 0 0 1-2.34 1.32c-.83 0-1.54-.25-2.1-.76a2.39 2.39 0 0 1-.83-1.88c0-.8.3-1.42.89-1.9a3.7 3.7 0 0 1 2.37-.7c.85 0 1.54.16 2.09.46v-.33c0-.49-.22-.96-.59-1.28a2.05 2.05 0 0 0-1.37-.53c-.79 0-1.42.34-1.88 1.02l-1.25-.8c.67-.99 1.69-1.49 3.04-1.49zm-1.84 5.58c0 .38.18.73.47.94.32.25.7.39 1.1.38.6 0 1.18-.25 1.6-.68.47-.44.7-.97.7-1.58a2.81 2.81 0 0 0-1.85-.53c-.57 0-1.06.14-1.44.42-.39.28-.58.63-.58 1.05z"}),e.jsx("path",{fill:"#3C4043",d:"M41.49 12.44 36.74 23.5h-1.47l1.77-3.87-3.12-7.19h1.55l2.25 5.52h.03l2.2-5.52z"}),e.jsx("path",{fill:"#4285F4",d:"M15.46 14.59c0-.44-.04-.88-.1-1.3h-6v2.47h3.43a2.99 2.99 0 0 1-1.27 1.97v1.6h2.05a6.33 6.33 0 0 0 1.89-4.74z"}),e.jsx("path",{fill:"#34A853",d:"M9.36 20.9c1.71 0 3.16-.58 4.2-1.56l-2.04-1.62a3.81 3.81 0 0 1-5.73-2.04H3.7v1.67a6.34 6.34 0 0 0 5.67 3.54z"}),e.jsx("path",{fill:"#FBBC04",d:"M5.8 15.68a3.94 3.94 0 0 1 0-2.47v-1.66H3.67a6.47 6.47 0 0 0 0 5.79l2.11-1.66z"}),e.jsx("path",{fill:"#EA4335",d:"M9.36 10.55a3.4 3.4 0 0 1 2.43.97l1.82-1.84A6.09 6.09 0 0 0 9.36 8c-2.4 0-4.6 1.38-5.68 3.56l2.11 1.66a3.8 3.8 0 0 1 3.57-2.67z"}),e.jsx("path",{fill:"#B0B0B0",d:"M2.04 1C1.47 1 1 1.47 1 2.05v27.9c0 .58.47 1.05 1.04 1.05h39.92c.57 0 1.04-.47 1.04-1.05V2.05C43 1.47 42.53 1 41.96 1H2.04zM0 2.05C0 .92.9 0 2.04 0h39.92C43.1 0 44 .92 44 2.05v27.9c0 1.13-.9 2.05-2.04 2.05H2.04A2.04 2.04 0 0 1 0 29.95V2.05z"})]})}),e.jsx("p",{children:"Google pay"})]})]})}),r&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"card-details grid",children:[e.jsx("input",{className:"card-number",type:"text",name:"cardNum",pattern:"[0-9]{16}",value:a.card.cardNum||"5968 4856 5263 4875",placeholder:"Card number",onChange:s}),e.jsx("input",{className:"expiration",pattern:"\\d{2}/\\d{2}",name:"expDate",type:"text",value:a.card.expDate||"4/26",placeholder:"Expiration",onChange:s}),e.jsx("input",{className:"cvv",type:"text",pattern:"\\d{3,4}",name:"cvv",placeholder:"CVV",value:a.card.cvv||"986",onChange:s})]}),e.jsx("input",{className:"zip",name:"zip",type:"text",value:a.card.zip||"48596",placeholder:"ZIP code",onChange:s}),e.jsx("input",{className:"country",name:"country",type:"text",value:a.card.country||a.card.region||"Israel",placeholder:"Country/region",onChange:s})]})]})]})}function U({onModal:a,userOrderDetails:s,onUserOrderDetails:r}){return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overlay",onClick:()=>a(null)}),e.jsxs("div",{className:"phone-modal flex column",children:[e.jsxs("header",{className:"flex center",children:[e.jsx("button",{onClick:()=>a(null),className:"close-btn"}),e.jsx("h2",{children:"Add phone number"})]}),e.jsxs("main",{children:[e.jsx("p",{children:"We’ll send you trip updates and a text to verify this number."}),e.jsx("input",{type:"tel",name:"phone",value:s.phone||"054-782-1812",placeholder:"Phone number",pattern:"\\d{3}-\\d{3}-\\d{4}",onChange:r}),e.jsx("p",{children:"We'll text you a code to confirm your number. Standard message and data rates apply."}),e.jsx("button",{className:"add-btn",onClick:()=>a(null),children:"Continue"})]})]})]})}function q({stay:a,order:s}){const[r,i]=t.useState(!0),h=Math.ceil(n.calcSumToPay({entryDate:+s.entryDate,exitDate:+s.exitDate,adults:s.guests.adults,children:s.guests.children},a)),x=M();function d(p){p.stopPropagation(),i(!1),x("/trips")}function m(){x("/messages")}return r&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overlay",onClick:d}),e.jsxs("section",{className:"order-confirmation",children:[e.jsxs("header",{className:"order-header flex center",children:[e.jsx("button",{onClick:d,className:"exit-btn flex center"}),e.jsx("h1",{className:"order-reserved",children:"Reservation confirmed"})]}),e.jsxs("div",{className:"order-details grid",children:[e.jsx("img",{src:a.imgUrls[0],title:a.name}),e.jsx("h1",{children:"Reservation details"}),e.jsxs("div",{className:"user flex column",children:[e.jsx("p",{children:"Guest name:"}),e.jsx("h5",{children:s.buyer.fullname})]}),e.jsxs("div",{className:"stay-name flex column",children:[e.jsx("p",{children:"Property name:"}),e.jsxs("h5",{children:[a.propertyType," in ",a.loc.city,", ",a.loc.country]})]}),e.jsxs("div",{className:"booking-number flex column",children:[e.jsx("p",{children:"Booking number:"}),e.jsx("h5",{children:s._id.slice(18)})]}),e.jsxs("div",{className:"dates grid",children:[e.jsxs("div",{className:"flex column",children:[e.jsx("p",{children:"Check-in:"}),e.jsx("h5",{children:n.timestampToFullDate(+s.entryDate)})]}),e.jsxs("div",{className:"flex column",children:[e.jsx("p",{children:"Check-out:"}),e.jsx("h5",{children:n.timestampToFullDate(+s.exitDate)})]})]}),e.jsxs("div",{className:"guests-rooms grid",children:[e.jsxs("div",{className:"guests-container flex column",children:[e.jsxs("div",{className:"guests flex",children:[e.jsx("p",{children:"Total guests:"}),e.jsx("h5",{children:n.calcGuestCount(s)})]}),e.jsxs("ul",{children:[+s.guests.adults>0&&e.jsx("li",{children:+s.guests.adults==1?`${s.guests.adults} adult`:`${s.guests.adults} adults`}),+s.guests.children>0&&e.jsx("li",{children:+s.guests.children==1?`${s.guests.children} child`:`${s.guests.children} children`}),+s.guests.infants>0&&e.jsx("li",{children:+s.guests.infants==1?`${s.guests.infants} infant`:`${s.guests.infants} infants`}),+s.guests.pets>0&&e.jsx("li",{children:+s.guests.pets==1?`${s.guests.pets} pet`:`${s.guests.pets} pets`})]})]}),e.jsxs("div",{className:"rooms flex column",children:[e.jsx("p",{children:"Total Rooms:"}),e.jsx("h5",{children:s.stay.sumOfBedrooms})]})]}),e.jsxs("div",{className:"price flex column",children:[e.jsxs("div",{className:"flex space-between",children:[e.jsx("p",{children:"Price:"}),e.jsxs("p",{className:"flex align-center",children:["$ ",a.price," X ",n.calcSumOfDays({entryDate:s.entryDate,exitDate:s.exitDate})," nights",e.jsxs("span",{children:["$ ",Math.ceil(h)]})]})]}),e.jsxs("div",{className:"flex space-between",children:[e.jsx("p",{children:"Service fee:"}),e.jsxs("p",{children:["$ ",Math.ceil(h*.14125)]})]}),e.jsxs("div",{className:"flex space-between",children:[e.jsx("h4",{children:"Total:"}),e.jsx("p",{children:e.jsxs("span",{children:["$ ",Math.ceil(h)+Math.ceil(h*.14125)]})})]})]})]}),e.jsxs("footer",{className:"flex align-center space-evenly",children:[e.jsx("button",{className:"close-btn flex center",onClick:d,children:"Close"}),e.jsx("button",{className:"msg-btn flex center",onClick:()=>m(),children:"Message host"})]})]})]})}const K=()=>{const{stayId:a}=T();R();const s=M(),[r,i]=V(),{adults:h,children:x,infants:d,pets:m,entryDate:p,exitDate:j}=Object.fromEntries(r.entries()),[l,g]=t.useState({adults:h,children:x,infants:d,pets:m,entryDate:p,exitDate:j}),[o,k]=t.useState(""),[S,H]=t.useState(null),[v,N]=t.useState({card:{cardNum:"",expDate:"",cvv:"",zip:""},phone:""}),[P,D]=t.useState(!1),[y,B]=t.useState(null);t.useEffect(()=>{a&&F()},[]),t.useEffect(()=>{i(l)},[l]);async function F(){try{const c=await z.getById(a);k(c)}catch(c){console.log(c)}}async function $(){try{const c=await E(l,o);H(c),D(!0)}catch(c){throw console.log("err",c),c}}function w(c){c.stopPropagation();const{value:C,name:b}=c.target;b in v.card&&N(f=>({...f,card:{...f.card,[b]:C}})),b==="phone"&&N(f=>({...f,phone:C}))}function u(c=null){B(c)}function A(){s(`/${o._id}?${n.getFormattedParams(l)}`)}return o?e.jsxs("section",{className:"stay-payment grid",children:[e.jsxs("section",{className:"payment-details",children:[e.jsxs("header",{className:"flex",children:[e.jsx("button",{className:"back-btn",onClick:A}),e.jsx("h1",{children:o.isInstantBooking?"Confirm to pay":"Request to book"})]}),e.jsxs("article",{className:"reservation-details",children:[e.jsx("h2",{children:"Your trip"}),e.jsxs("div",{className:"dates flex space-between",children:[e.jsxs("div",{className:"flex column",children:[e.jsx("h4",{children:"Dates"}),e.jsx("p",{children:n.timestampsToShortDates(+l.entryDate,+l.exitDate)})]}),e.jsx("button",{onClick:()=>u("dates"),children:"Edit"})]}),e.jsxs("div",{className:"guests flex space-between",children:[e.jsxs("div",{className:"flex column",children:[e.jsx("h4",{children:"Guests"}),e.jsx("p",{children:z.guestCountStringForReservation(l)})]}),e.jsx("button",{onClick:()=>u("guests"),children:"Edit"})]}),y==="guests"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"clearOverlay",onClick:()=>u(null)})," ",e.jsx(I,{stay:o,searchParams:l,setSearchParams:g,onModal:u})]}),y==="dates"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"clearOverlay",onClick:()=>u(null)})," ",e.jsx(O,{stay:o,searchParams:l,setSearchParams:g})]})]}),o&&e.jsxs(e.Fragment,{children:[e.jsx(L,{userOrderDetails:v,onUserOrderDetails:w}),e.jsxs("article",{className:"required-info",children:[e.jsx("h2",{children:"Required for your trip"}),e.jsxs("div",{className:"flex space-between",children:[e.jsxs("div",{className:"text flex column",children:[e.jsx("h4",{children:"Phone number"}),e.jsx("p",{children:"Add and confirm your phone number to get trip updates."})]}),e.jsx("button",{onClick:()=>u("phone"),children:"Add"})]}),y==="phone"&&e.jsx(U,{onModal:u,userOrderDetails:v,onUserOrderDetails:w})]}),e.jsxs("article",{className:"cancellation-policy flex column",children:[e.jsx("h2",{children:"Cancellation policy"}),e.jsxs("p",{children:["This reservation is non-refundable. ",e.jsx("span",{className:"learn-policy",children:"Learn more"})]})]}),e.jsxs("article",{className:"ground-rules",children:[e.jsx("h2",{children:"Ground rules"}),e.jsx("p",{children:"We ask every guest to remember a few simple things about what makes a great guest."}),e.jsxs("ul",{className:"rules",children:[e.jsx("li",{children:"Follow the house rules"}),e.jsx("li",{children:"Treat your Host’s home like your own"})]})]}),e.jsxs("article",{className:"confirmation flex column",children:[e.jsxs("p",{children:["By selecting the button below, I agree to the ",e.jsx("span",{children:"Host's House Rules"}),", ",e.jsx("span",{children:"Ground rules for guests"}),", ",e.jsx("span",{children:"Airbnb's Rebooking and Refund Policy"}),", and that Airbnb can ",e.jsx("span",{children:"charge my payment method"})," if I’m responsible for damage."]}),e.jsx("button",{className:"confirm-btn",onClick:$,children:"Confirm and pay"})]}),P&&e.jsx(q,{stay:o,order:S})]})]}),e.jsx(_,{stay:o,searchParams:l})]}):e.jsx(G,{currentPage:"payment"})};export{K as default};
