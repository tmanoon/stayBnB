import{b as g,j as e,u as a,r as t,l as k,w as D,x as A,i as P}from"./index-33d448ca.js";import{o as p}from"./order.service-8e12d46e.js";function U({trip:s,setOnModal:x}){const d=g();function c(o){o.stopPropagation(),x(!1)}function l(){return Object.values(s.guests).reduce((o,h)=>o+h,0)}function j(){d("/messages")}return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overlay",onClick:c}),e.jsxs("section",{className:`order-confirmation trip-modal ${s.status}`,children:[e.jsxs("header",{className:"order-header flex center",children:[e.jsx("button",{onClick:c,className:"exit-btn"}),s.status==="approved"&&e.jsx("h1",{className:"order-reserved",children:"Reservation confirmed"}),s.status==="pending"&&e.jsx("h1",{className:"order-reserved",children:"Reservation pending"}),s.status==="rejected"&&e.jsx("h1",{className:"order-reserved",children:"Reservation rejected"})]}),e.jsxs("div",{className:"order-details grid",children:[e.jsx("img",{src:s.stay.imgUrls[0],alt:s.stay.name}),e.jsx("h1",{children:"Trip details"}),e.jsxs("div",{className:"booking-number flex column",children:[e.jsx("p",{children:"Booking number:"}),e.jsx("h5",{children:s._id.slice(18)})]}),e.jsxs("div",{className:"stay-name flex column",children:[e.jsx("p",{children:"Property name:"}),e.jsx("h5",{children:s.stay.name})]}),e.jsxs("div",{className:"stay-name flex column",children:[e.jsx("p",{children:"Location:"}),e.jsx("h5",{children:s.stay.location.address})]}),e.jsxs("div",{className:"dates grid",children:[e.jsxs("div",{className:"flex column",children:[e.jsx("p",{children:"Check-in:"}),e.jsx("h5",{children:a.timestampToFullDate(+s.entryDate)})]}),e.jsxs("div",{className:"flex column",children:[e.jsx("p",{children:"Check-out:"}),e.jsx("h5",{children:a.timestampToFullDate(+s.exitDate)})]})]}),e.jsxs("div",{className:"guests-rooms grid",children:[e.jsxs("div",{className:"guests-container flex column",children:[e.jsxs("div",{className:"guests flex align-center",children:[e.jsx("p",{children:"Total guests:"}),e.jsxs("h5",{children:["  ",l()]})]}),e.jsxs("ul",{children:[+s.guests.adults>0&&e.jsxs("li",{children:[" ",s.guests.adults," adult",s.guests.adults===1?"":"s"]}),+s.guests.children>0&&e.jsxs("li",{children:[s.guests.children," child",s.guests.children===1?"":"ren"]}),+s.guests.infants>0&&e.jsxs("li",{children:[s.guests.infants," infant",s.guests.infants===1?"":"s"]}),+s.guests.pets>0&&e.jsxs("li",{children:[s.guests.pets," pet",s.guests.pets===1?"":"s"]})]})]}),e.jsxs("div",{className:"rooms flex column",children:[e.jsx("p",{children:"Total Rooms:"}),e.jsx("h5",{children:s.stay.sumOfBedrooms})]})]}),e.jsxs("div",{className:"price flex column",children:[e.jsxs("div",{className:"flex space-between",children:[e.jsx("p",{children:"Price:"}),e.jsxs("p",{className:"flex align-center",children:["$ ",s.stay.price," X ",a.calcSumOfDays(s)," nights     ",e.jsxs("span",{children:["$ ",a.calcSumToPayAtTrips(s,s.stay)]})]})]}),e.jsxs("div",{className:"flex space-between",children:[e.jsx("p",{children:"Service fee:"}),e.jsxs("p",{children:["$ ",(a.calcSumToPayAtTrips(s,s.stay)*.14125).toFixed(2)]})]}),e.jsxs("div",{className:"flex space-between",children:[e.jsx("h4",{children:"Total:"}),e.jsx("p",{children:e.jsxs("span",{children:["$ ",(a.calcSumToPayAtTrips(s,s.stay)+a.calcSumToPayAtTrips(s,s.stay)*.14125).toLocaleString()]})})]})]})]}),e.jsxs("footer",{className:"order-details-footer flex center",children:[e.jsx("button",{className:"close-btn flex center",onClick:c,children:"Close"}),e.jsx("button",{className:"msg-btn flex center",onClick:j,children:"Message host"})]})]})]})}const w=()=>{const[s,x]=t.useState([]),[d,c]=t.useState([]),[l,j]=t.useState({tense:"future",status:"all"}),[o,h]=t.useState(!1),[v,N]=t.useState(null),[m,y]=t.useState("cards"),T=g();k(n=>n.stayModule),t.useEffect(()=>{D.on(A,b),(async()=>{try{const r=P.getLoggedInUser(),i=await p.getUserOrdersById(r._id);x(i)}catch(r){console.log(r)}})()},[]),t.useEffect(()=>{if(s.length>0){const n=p.filterUserOrders(s,l);c(n)}},[s,l]);function u({target:n}){const{name:r,value:i}=n;j(S=>({...S,[r]:i}))}function C(n){N(n),h(!0)}function f(n){y(n)}function b(n){c(r=>r.map(i=>i._id===n._id?n:i))}return!s||!s.length?e.jsxs("section",{className:"user-trips no-user-trips",children:[e.jsx("header",{children:e.jsx("h1",{children:"Trips"})}),e.jsxs("div",{children:[e.jsx("h2",{children:"No trips booked...yet!"}),e.jsx("p",{children:"Time to dust off your bags and start planning your next adventure"}),e.jsx("button",{onClick:()=>T("/"),children:"Start searching"})]}),e.jsxs("p",{children:["Can't find your reservation here? ",e.jsx("span",{children:"Visit the Help Center"})]})]}):!d||!d.length?e.jsxs("section",{className:"user-trips no-user-trips",children:[e.jsxs("header",{className:"flex align-center space-between",children:[e.jsx("h1",{children:"Trips"}),e.jsxs("div",{className:"filters flex",children:[e.jsxs("select",{name:"tense",value:l.tense,onChange:u,children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"future",children:"Future"}),e.jsx("option",{value:"current",children:"Current"}),e.jsx("option",{value:"past",children:"Past"})]}),e.jsxs("select",{name:"status",value:l.status,onChange:u,children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"rejected",children:"Rejected"})]})]})]}),l.tense==="all"&&e.jsx("h2",{children:"All reservations"}),l.tense==="future"&&e.jsx("h2",{children:"Upcoming reservations"}),l.tense==="current"&&e.jsx("h2",{children:"Current reservations"}),l.tense==="past"&&e.jsx("h2",{children:"Past reservations"}),e.jsx("div",{children:e.jsx("h2",{children:"No trips to show"})}),e.jsxs("p",{children:["Can't find your reservation here? ",e.jsx("span",{children:"Visit the Help Center"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("section",{className:"user-trips",children:[e.jsxs("header",{className:"flex align-center space-between",children:[e.jsx("h1",{children:"Trips"}),e.jsxs("div",{className:"filters flex",children:[e.jsxs("div",{className:"layout-btns flex align-center",children:[e.jsx("button",{onClick:()=>f("lines"),className:`lines flex center ${m==="lines"?"selected":""}`}),e.jsx("button",{onClick:()=>f("cards"),className:`cards flex center ${m==="cards"?"selected":""}`})]}),e.jsxs("select",{name:"tense",value:l.tense,onChange:u,children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"future",children:"Future"}),e.jsx("option",{value:"current",children:"Current"}),e.jsx("option",{value:"past",children:"Past"})]}),e.jsxs("select",{name:"status",value:l.status,onChange:u,children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"rejected",children:"Rejected"})]})]})]}),l.tense==="all"&&e.jsx("h2",{children:"All reservations"}),l.tense==="future"&&e.jsx("h2",{children:"Upcoming reservations"}),l.tense==="current"&&e.jsx("h2",{children:"Current reservations"}),l.tense==="past"&&e.jsx("h2",{children:"Past reservations"}),e.jsx("ul",{className:`grid ${m}`,children:d.map(n=>e.jsxs("li",{className:`trip-card grid ${n.status}`,onClick:()=>C(n),children:[e.jsxs("div",{className:"title flex column",children:[e.jsx("h3",{children:n.stay.name}),e.jsxs("p",{children:[e.jsx("span",{children:"Booking number:"}),"  ",n._id.slice(18)]})]}),e.jsx("div",{className:"dates",children:e.jsx("h4",{children:a.timestampsToShortDates(+n.entryDate,+n.exitDate)})}),e.jsxs("div",{className:"address flex column",children:[e.jsx("p",{children:n.stay.location.address}),e.jsx("p",{children:n.stay.location.city}),e.jsx("p",{children:n.stay.location.country})]}),e.jsxs("div",{className:"image",children:[e.jsx("img",{src:n.stay.imgUrls[0],alt:n.stay.name}),e.jsxs("p",{children:[a.timestampDaysAway(+n.entryDate,+n.exitDate)," |",e.jsxs("span",{className:`status ${n.status}`,children:[" ",n.status]})]})]})]},n._id))}),e.jsxs("p",{children:["Can't find your reservation here? ",e.jsx("span",{children:"Visit the Help Center"})]})]}),o&&v&&e.jsx(U,{trip:v,setOnModal:h})]})};export{w as default};
